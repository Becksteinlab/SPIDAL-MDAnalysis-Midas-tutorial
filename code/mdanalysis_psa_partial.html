<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>mdanalysis_psa_partial.py &#8212; SPIDAL Tutorial: MDAnalysis with Midas 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/mdanalysis-logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="rp_psa.py" href="rp_psa.html" />
    <link rel="prev" title="Available code" href="listings.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mdanalysis-psa-partial-py">
<h1>mdanalysis_psa_partial.py<a class="headerlink" href="#mdanalysis-psa-partial-py" title="Permalink to this headline">Â¶</a></h1>
<p>The <code class="file docutils literal"><span class="pre">rp/mdanalysis_psa_partial.py</span></code> script performs the path
similarity analysis on a subset of trajectories and computes a
sub-block of the distance matrix. All MDAnalysis specific-code is
confined to this file.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># Perform Path Similarity Analysis on a submatrix</span>

<span class="sd">&quot;&quot;&quot;Perform Path Similarity Analysis (PSA) using MDAnalysis.analysis.psa.</span>

<span class="sd">Provide all trajectories and topology files in a JSON input file (two</span>
<span class="sd">lists, one with topology files, the other with trajectory files) or on</span>
<span class="sd">the command line. There *must* be one topology file TOPOL for each</span>
<span class="sd">trajectory file TRAJ. The `--nsplit N` argument is required: it</span>
<span class="sd">indicates where to split the list of trajectories T so that the</span>
<span class="sd">distance matrix between the trajectories in `T[:N]` and `T[N:]`.</span>

<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="kn">as</span> <span class="nn">mda</span>
<span class="kn">from</span> <span class="nn">MDAnalysis.analysis</span> <span class="kn">import</span> <span class="n">psa</span>

<span class="k">def</span> <span class="nf">psa_partial</span><span class="p">(</span><span class="n">universesA</span><span class="p">,</span> <span class="n">universesB</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;discrete_frechet&quot;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;name CA&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate path similarity metric between lists of universes.</span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    universesA, universesB : lists</span>
<span class="sd">         lists of MDAnalysis.Universe instances</span>
<span class="sd">    metric : string, optional</span>
<span class="sd">         label of the metric or distance function, can be one of &quot;discrete_frechet&quot;,</span>
<span class="sd">         &quot;hausdorff&quot;, &quot;weighted_average_hausdorff&quot;, &quot;average_hausdorff&quot;,</span>
<span class="sd">         &quot;hausdorff_neighbors&quot;. Note that only &quot;discrete_frechet&quot; and &quot;hausdorff&quot;</span>
<span class="sd">         are true metrics.</span>
<span class="sd">    selection : string, optional</span>
<span class="sd">         MDAnalysis selection string that, when applied to *all* universes generates</span>
<span class="sd">         the subset of atoms that should be compared.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy.array(len(universesA), len(universesB)) : distance matrix</span>
<span class="sd">         The matrix of all the mutual distances D[i, j] with 0 &lt;= i &lt;</span>
<span class="sd">         len(A) and 0 &lt;= j &lt; len(B)</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Each universe should be transferred to memory</span>
<span class="sd">    (`Universe.transfer_to_memory()`) in order to speed up extraction</span>
<span class="sd">    of coordinates. However, for very big trajectories, memory</span>
<span class="sd">    problems might occur and then this code is not optimal because it does</span>
<span class="sd">    not cache extracted coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_metric</span> <span class="o">=</span> <span class="n">psa</span><span class="o">.</span><span class="n">get_path_metric_func</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>

    <span class="c1"># submatrix of d[i, j] with i from A and j from B</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">universesA</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">universesB</span><span class="p">)))</span>

    <span class="c1"># not optimized: could transpose to keep larger axis outside,</span>
    <span class="c1"># cache results (compare u_i and u_j), and generate 0 for u_i == u_j</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">u_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">universesA</span><span class="p">):</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="n">u_i</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">u_i</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">timeseries</span><span class="p">(</span><span class="n">asel</span><span class="o">=</span><span class="n">g1</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s2">&quot;fac&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">u_j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">universesB</span><span class="p">):</span>
            <span class="n">g2</span> <span class="o">=</span> <span class="n">u_j</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="n">u_j</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">timeseries</span><span class="p">(</span><span class="n">asel</span><span class="o">=</span><span class="n">g2</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s2">&quot;fac&quot;</span><span class="p">)</span>

            <span class="c1"># compute distance between paths</span>
            <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">_metric</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">D</span>

<span class="k">class</span> <span class="nc">StopWatch</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;{0:30s}  {1:8.3f} s&quot;</span>

    <span class="k">def</span> <span class="nf">tic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;label {} already exists&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;----------[ TIMING ]--------------------&quot;</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">stop</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">stop</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="p">[</span><span class="n">start</span><span class="p">]</span>
            <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;----------------------------------------&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;total time&quot;</span><span class="p">,</span>
                              <span class="bp">self</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="bp">self</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;----------------------------------------&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="s2">&quot;--nsplit&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;split list of trajectories T so that the distance &quot;</span>
                        <span class="s2">&quot;submatrix D[i, j] will be calculated over the cartesian &quot;</span>
                        <span class="s2">&quot;product T[:N] x T[N:].&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;--inputfile&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;JSON file with lists of topologies and &quot;</span>
                        <span class="s2">&quot;trajectories (or use --trajectories/--topologies)&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--topologies&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span>
                        <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;TOPOLOGY&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;List of topology files&quot;</span><span class="p">),</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--trajectories&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span>
                        <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;TRAJ&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;List of trajectory files&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="s2">&quot;--outfile&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;distances.npy&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Distance matrix in numpy format&quot;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">inputfile</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Loading paths from JSON file {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">inputfile</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">inputfile</span><span class="p">)</span> <span class="k">as</span> <span class="n">inp</span><span class="p">:</span>
            <span class="n">topologies</span><span class="p">,</span> <span class="n">trajectories</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Using paths from command line&quot;</span><span class="p">)</span>
        <span class="n">topologies</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">topologies</span>
        <span class="n">trajectories</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">trajectories</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">topologies</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trajectories</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need exactly one topology file for each trajectory&quot;</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Processing {} trajectories.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trajectories</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Splitting trajectories in two blocks of length {0} and {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
         <span class="n">args</span><span class="o">.</span><span class="n">nsplit</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">trajectories</span><span class="p">)</span> <span class="o">-</span> <span class="n">args</span><span class="o">.</span><span class="n">nsplit</span><span class="p">))</span>

    <span class="n">timer</span> <span class="o">=</span> <span class="n">StopWatch</span><span class="p">()</span>
    <span class="n">timer</span><span class="o">.</span><span class="n">tic</span><span class="p">(</span><span class="s1">&#39;init&#39;</span><span class="p">)</span>

    <span class="c1"># load trajectories</span>
    <span class="n">universes</span> <span class="o">=</span> <span class="p">[</span><span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span> <span class="k">for</span> <span class="n">topology</span><span class="p">,</span> <span class="n">trajectory</span> <span class="ow">in</span>
                 <span class="n">itertools</span><span class="o">.</span><span class="n">izip</span><span class="p">(</span><span class="n">topologies</span><span class="p">,</span> <span class="n">trajectories</span><span class="p">)]</span>
    <span class="n">timer</span><span class="o">.</span><span class="n">tic</span><span class="p">(</span><span class="s2">&quot;load Universes&quot;</span><span class="p">)</span>

    <span class="c1"># speed up by transferring to memory</span>
    <span class="c1"># transfer to memory for instantaneous time series extraction</span>
    <span class="c1"># (typically not a problem for these trajectories and submatrix sizes; if memory becomes an</span>
    <span class="c1"># issue then do not transfer to memory and store intermediate trajectories on disk)</span>
    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">universes</span><span class="p">:</span>
        <span class="n">u</span><span class="o">.</span><span class="n">transfer_to_memory</span><span class="p">()</span>
    <span class="n">timer</span><span class="o">.</span><span class="n">tic</span><span class="p">(</span><span class="s2">&quot;universe.transfer_to_memory()&quot;</span><span class="p">)</span>

    <span class="c1"># run distance calculation and produce submatrix</span>

    <span class="n">uA</span> <span class="o">=</span> <span class="n">universes</span><span class="p">[:</span><span class="n">args</span><span class="o">.</span><span class="n">nsplit</span><span class="p">]</span>
    <span class="n">uB</span> <span class="o">=</span> <span class="n">universes</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">nsplit</span><span class="p">:]</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Calculating D (shape {0} x {1}) with {2} entries&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
         <span class="nb">len</span><span class="p">(</span><span class="n">uA</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uB</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uA</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">uB</span><span class="p">)))</span>

    <span class="n">D</span> <span class="o">=</span> <span class="n">psa_partial</span><span class="p">(</span><span class="n">uA</span><span class="p">,</span> <span class="n">uB</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;discrete_frechet&quot;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;name CA&quot;</span><span class="p">)</span>

    <span class="n">timer</span><span class="o">.</span><span class="n">tic</span><span class="p">(</span><span class="s2">&quot;PSA distance matrix&quot;</span><span class="p">)</span>

    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">outfile</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
    <span class="n">timer</span><span class="o">.</span><span class="n">tic</span><span class="p">(</span><span class="s2">&quot;saving output&quot;</span><span class="p">)</span>

    <span class="n">timer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


</pre></div>
</td></tr></table></div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logos/mdanalysistutorial-logo-200x150.png" alt="Logo"/>
    
  </a>
</p>










<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datafiles.html">Data files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="listings.html">Available code</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">mdanalysis_psa_partial.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="rp_psa.html">rp_psa.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="psa_reduce.html">psa_reduce.py</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="http://spidal.org">SPIDAL</a></li>
    
    <li class="toctree-l1"><a href="http://mdanalysis.org">MDAnalysis</a></li>
    
    <li class="toctree-l1"><a href="https://radical-cybertools.github.io/">Radical Cybertools</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="listings.html">Available code</a><ul>
      <li>Previous: <a href="listings.html" title="previous chapter">Available code</a></li>
      <li>Next: <a href="rp_psa.html" title="next chapter">rp_psa.py</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Oliver Beckstein, Ioannis Paraskevakos, Sean Seyler, Andre Merzky, Andre Luckow, Shantenu Jha.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="../_sources/code/mdanalysis_psa_partial.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/MDAnalysis/mdanalysis" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>